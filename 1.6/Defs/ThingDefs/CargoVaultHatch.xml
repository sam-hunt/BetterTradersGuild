<?xml version="1.0" encoding="utf-8"?>
<Defs>
  <!--
    Better Traders Guild - Cargo Vault Entrance Portal

    The hackable hatch entrance to the secure cargo vault pocket map accessible
    from the ShuttleBay.

    IMPORTANT:
    - Uses custom BTG_CargoVaultHatch ThingClass (NOT vanilla AncientHatch)
    - This prevents vanilla's AncientStockpile GenStep from generating
    - All pocket map generation is controlled by BTG_CargoVault MapGeneratorDef
    - Uses AncientHatch textures for visual consistency

    The hatch provides access to a secure orbital cargo vault containing valuable
    trade goods protected by automated defenses.
  -->

  <!-- Cargo Vault Entrance - Placed in ShuttleBay -->
  <ThingDef ParentName="BuildingBase">
    <defName>BTG_CargoVaultHatch</defName>
    <label>secure cargo vault hatch</label>
    <description>A reinforced hatch leading to the station's secure cargo vault. The vault below contains high-value trade goods under automated security. Hack the access panel to override the lock.</description>
    <size>(3,3)</size>
    <useHitPoints>false</useHitPoints>
    <thingClass>BetterTradersGuild.MapGeneration.CargoVaultHatch</thingClass>
    <rotatable>false</rotatable>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <canOverlapZones>false</canOverlapZones>
    <tickerType>Normal</tickerType>

    <!-- Reuse AncientHatch graphics -->
    <graphicData>
      <graphicClass>Graphic_Single</graphicClass>
      <texPath>Things/Building/AncientHatch/AncientHatch_Closed</texPath>
      <drawSize>(3, 3)</drawSize>
    </graphicData>

    <altitudeLayer>FloorEmplacement</altitudeLayer>
    <fillPercent>0</fillPercent>
    <passability>Impassable</passability>
    <holdsRoof>true</holdsRoof>
    <destroyable>false</destroyable>

    <building>
      <isEdifice>true</isEdifice>
      <deconstructible>false</deconstructible>
      <isTargetable>false</isTargetable>
      <isInert>true</isInert>
      <claimable>false</claimable>
      <expandHomeArea>false</expandHomeArea>
    </building>

    <!-- Portal configuration - links to our custom pocket map -->
    <!-- Map size = 75x75 with 25x25 vault structure centered inside, plus surrounding ring -->
    <portal>
      <pocketMapGenerator>BTG_CargoVaultMapGenerator</pocketMapGenerator>
      <exitDef>BTG_CargoVaultExit</exitDef>
      <pocketMapSize>75</pocketMapSize>
    </portal>

    <statBases>
      <Flammability>0</Flammability>
    </statBases>

    <comps>
      <!-- Hackable with moderate difficulty - easier than ancient stockpile (39000) -->
      <li Class="CompProperties_Hackable">
        <defence>10000</defence>
        <effectHacking>HackingTerminal</effectHacking>
        <lockoutDurationHoursRange>2~8</lockoutDurationHoursRange>
        <showProgressAfterHackCompletion>false</showProgressAfterHackCompletion>
        <notHackedInspectString>Hack to override security lock.</notHackedInspectString>
        <intellectualSkillPrerequisite>6</intellectualSkillPrerequisite>
        <hackingCompletedSound>AncientHatchOpened</hackingCompletedSound>
        <hackedMessage>{HACKER_labelShort} has bypassed the security on {SUBJECT_labelNoParenthesisDef}.</hackedMessage>
      </li>

      <!-- Allow relocking after raiding (reusable, not permanent) -->
      <!-- Label/desc use Keyed translations: BTG_CargoVaultHatch_RelockLabel/Desc -->
      <li Class="BetterTradersGuild.Comps.CompProperties_Relockable">
        <relockTexPath>UI/Commands/SealHatch</relockTexPath>
      </li>

      <!-- Orange glow for locked state (swapped to green on hack via code) -->
      <li Class="CompProperties_Glower">
        <glowRadius>3</glowRadius>
        <glowColor>(255,140,0,0)</glowColor>
      </li>
    </comps>

    <inspectorTabs>
      <li>ITab_ContentsMapPortal</li>
    </inspectorTabs>
  </ThingDef>
</Defs>
