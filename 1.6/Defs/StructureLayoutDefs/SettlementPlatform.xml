<?xml version="1.0" encoding="utf-8"?>
<Defs>
  <!--
    TradersGuild Orbital Settlement Layout

    This LayoutDef defines the structure for TradersGuild space settlements.
    Key design principles:
    - Modern, functional aesthetics (not ancient/deserted)
    - Static base infrastructure (rooms/walls permanent)
    - ONE dynamic cargo bay (ShuttleBay) for trader-specific loot
    - Reflects prosperous merchant civilization identity

    Inherits from OrbitalAncientPlatformBase for standard orbital platform behavior.
    Same base def as vanilla settlements.
  -->

  <StructureLayoutDef ParentName="OrbitalAncientPlatformBase">
    <defName>BTG_SettlementPlatform</defName>

    <!--
      Custom LayoutWorker for BTG-specific generation hooks.
      Extends LayoutWorker_OrbitalPlatform with pre/post spawn processing:
      - Pre-spawn: Initialize TradersGuildSettlementComponent
      - Post-spawn: Conduits, pipes, tanks, valves, lighting
    -->
    <workerClass>BetterTradersGuild.LayoutWorkers.Settlement.LayoutWorker_Settlement</workerClass>

    <!--
      Settlement-specific settings:
      - clearDoorFaction=true: Removes door faction ownership (allows player to pass through)
      - ensureOneDoorUnlocked=false: Safe because MapGeneratorDef has defeatRequiresCantReachUnfogged=false,
        so enemies behind locked doors still count as active threats (no instant player victory)
      - corridorDef: Custom corridor with MetalTile flooring (not AncientTile)
      - wallLampDef: Powered WallLamp instead of AncientEmergencyLight_Blue (color set via worker)
    -->
    <clearDoorFaction>true</clearDoorFaction>
    <ensureOneDoorUnlocked>false</ensureOneDoorUnlocked>
    <corridorDef>BTG_Corridor</corridorDef>
    <wallLampDef>WallLamp</wallLampDef>
    <wallLampChancePerPosition>1</wallLampChancePerPosition>

    <wallAttachments>
      <LifeSupportUnit>
        <countRange>1~1</countRange>
      </LifeSupportUnit>
    </wallAttachments>

    <!-- Place ShuttleBay FIRST - it's the largest room (18x15) and needs priority placement -->
    <importantRoomDef>BTG_ShuttleBay</importantRoomDef>

    <roomDefs>
      <!-- Core operational facilities -->
      <!-- NOTE: BTG_ShuttleBay is handled via importantRoomDef (exactly 1 placed first) -->

      <!-- Control center with comms and AI core subroom -->
      <BTG_ControlCenter>
        <countRange>1~1</countRange>
      </BTG_ControlCenter>

      <!-- Commander's quarters with bedroom subroom-->
      <BTG_CommandersQuarters>
        <countRange>1~1</countRange>
      </BTG_CommandersQuarters>

      <!-- Nursery with sheltering civilians/children in subroom -->
      <BTG_Nursery MayRequire="Ludeon.RimWorld.Biotech">
        <countRange>1~1</countRange>
      </BTG_Nursery>

      <BTG_Classroom MayRequire="Ludeon.RimWorld.Biotech">
        <countRange>1~1</countRange>
      </BTG_Classroom>

      <BTG_MessHall>
        <countRange>1~1</countRange>
      </BTG_MessHall>

      <BTG_MedicalBay>
        <countRange>1~1</countRange>
      </BTG_MedicalBay>

      <BTG_PodLaunchBay>
        <countRange>1~1</countRange>
      </BTG_PodLaunchBay>

      <BTG_CrewQuarters>
        <countRange>2~4</countRange>
      </BTG_CrewQuarters>

      <BTG_Greenhouse>
        <countRange>2~4</countRange>
      </BTG_Greenhouse>

      <BTG_RecRoom>
        <countRange>1~1</countRange>
      </BTG_RecRoom>

      <BTG_MechSecurityPost>
        <countRange>0~2</countRange>
      </BTG_MechSecurityPost>

      <BTG_Armory>
        <countRange>0~1</countRange>
      </BTG_Armory>

      <BTG_Workshop>
        <countRange>0~1</countRange>
      </BTG_Workshop>

      <BTG_MechRepairPost MayRequire="Ludeon.RimWorld.Biotech">
        <countRange>0~2</countRange>
      </BTG_MechRepairPost>

      <!-- Filler rooms by weight -->
      <BTG_Storeroom>3</BTG_Storeroom>
      <NarrowHalls>2</NarrowHalls>
    </roomDefs>

    <!--
      Loot Control: Disable random littered loot across the structure
      - junkScaterrers: Prevents random debris/items from spawning in corridors/open areas
      - Loot is intentionally placed via room-specific prefabs (storage rooms, cargo bay)
      - This ensures thematic, curated loot placement rather than random scattering
    -->
    <junkScaterrers />

  </StructureLayoutDef>
</Defs>