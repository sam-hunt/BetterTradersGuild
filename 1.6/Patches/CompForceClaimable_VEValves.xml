<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!--
    Adds CompForceClaimable to VE pipe valve buildings.

    PURPOSE:
    Allows players to claim valves even when hostile pawns are elsewhere on the map.
    Vanilla claiming is blocked map-wide, preventing room-by-room progression.

    AFFECTED DEFS:
    - VCHE_ChemfuelValve (VE Chemfuel Expanded)
    - VNPE_NutrientPasteValve (VE Nutrient Paste Expanded)
    - VGE_OxygenValve (VE Gravships)
    - VGE_AstrofuelValve (VE Gravships)

    BEHAVIOR:
    Adds a "Force Claim" gizmo that appears when valve is not player-owned.
    Clicking it immediately transfers ownership to player faction.
  -->

  <!-- VE Chemfuel Expanded - Chemfuel Valve -->
  <Operation Class="PatchOperationConditional" MayRequire="VanillaExpanded.VChemfuelE">
    <xpath>/Defs/ThingDef[defName="VCHE_ChemfuelValve"]</xpath>
    <match Class="PatchOperationAdd">
      <xpath>/Defs/ThingDef[defName="VCHE_ChemfuelValve"]/comps</xpath>
      <value>
        <li Class="BetterTradersGuild.Comps.CompProperties_ForceClaimable" />
      </value>
    </match>
  </Operation>

  <!-- VE Nutrient Paste Expanded - Nutrient Paste Valve -->
  <Operation Class="PatchOperationConditional" MayRequire="VanillaExpanded.VNutrientE">
    <xpath>/Defs/ThingDef[defName="VNPE_NutrientPasteValve"]</xpath>
    <match Class="PatchOperationAdd">
      <xpath>/Defs/ThingDef[defName="VNPE_NutrientPasteValve"]/comps</xpath>
      <value>
        <li Class="BetterTradersGuild.Comps.CompProperties_ForceClaimable" />
      </value>
    </match>
  </Operation>

  <!-- VE Gravships - Oxygen Valve -->
  <Operation Class="PatchOperationConditional" MayRequire="vanillaexpanded.gravship">
    <xpath>/Defs/ThingDef[defName="VGE_OxygenValve"]</xpath>
    <match Class="PatchOperationAdd">
      <xpath>/Defs/ThingDef[defName="VGE_OxygenValve"]/comps</xpath>
      <value>
        <li Class="BetterTradersGuild.Comps.CompProperties_ForceClaimable" />
      </value>
    </match>
  </Operation>

  <!-- VE Gravships - Astrofuel Valve -->
  <Operation Class="PatchOperationConditional" MayRequire="vanillaexpanded.gravship">
    <xpath>/Defs/ThingDef[defName="VGE_AstrofuelValve"]</xpath>
    <match Class="PatchOperationAdd">
      <xpath>/Defs/ThingDef[defName="VGE_AstrofuelValve"]/comps</xpath>
      <value>
        <li Class="BetterTradersGuild.Comps.CompProperties_ForceClaimable" />
      </value>
    </match>
  </Operation>

</Patch>
